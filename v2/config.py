# config.py
"""
UGV(무인 차량) 프로젝트의 모든 하드웨어 핀, 포트, 통신 설정 및
소프트웨어 파라미터를 관리하는 중앙 설정 파일입니다.

(!!!) 표시가 있는 값은 실제 하드웨어 연결 및 환경에 맞게
사용자가 반드시 확인하고 수정해야 합니다.
"""

import os

# =================================================================
# 1. BOARD / ACTUATORS (모터 및 서보)
# =================================================================
# 라즈베리파이의 BCM 핀 번호 기준입니다.
# pigpio 라이브러리를 사용하므로, 실행 전 'sudo systemctl start pigpiod' 필수!

# (!!!) 왼쪽 모터 드라이버 핀 번호
MOTOR_LEFT_PWM = 12   # 속도 제어 (ENA)
MOTOR_LEFT_IN1 = 20   # 방향 1
MOTOR_LEFT_IN2 = 21   # 방향 2

# (!!!) 오른쪽 모터 드라이버 핀 번호
MOTOR_RIGHT_PWM = 13  # 속도 제어 (ENB)
MOTOR_RIGHT_IN1 = 19  # 방향 1
MOTOR_RIGHT_IN2 = 26  # 방향 2

# (!!!) 조향 서보 모터 PWM 신호선 핀 번호
STEER_SERVO_PIN = 18

# (!!!) 서보 펄스 폭(us) 설정. 사용하는 서보 모델에 맞게 미세 조정이 필요합니다.
# 500us ~ 2500us 사이에서 조절합니다.
SERVO_CENTER_PULSE = 1500  # 서보 중앙 정렬 시 펄스 값
SERVO_RANGE_PULSE  = 500   # 최대 조향 범위 (예: 500 -> 1000~2000us 범위로 조향)

# =================================================================
# 2. INPUT / SENSORS (센서)
# =================================================================

# (!!!) RPLIDAR C1 (USB 연결)
# 'dmesg | grep ttyUSB' 또는 'ls /dev/tty*' 명령어로 실제 포트를 확인하세요.
LIDAR_PORT = '/dev/ttyUSB0'

# OAK-D Lite (USB 연결)
# depthai 라이브러리가 자동으로 장치를 찾지만, 해상도 등 세부 설정이 가능합니다.
OAKD_RGB_RESOLUTION = (640, 480) # RGB 카메라 프리뷰 해상도
OAKD_RGB_FPS = 30.0              # RGB 카메라 FPS

# (!!!) WT901BLECL (블루투스 GPS/IMU)
GPS_DEVICE_NAME = 'WT901BLECL'  # 블루투스 스캔 시 표시되는 장치 이름

# (!!!) 데이터 수신용 Characteristic UUID. 이 값이 틀리면 데이터를 전혀 받을 수 없습니다.
# 반드시 제조사 문서나 nRF Connect 같은 앱으로 'Notify' 속성을 가진 UUID를 확인하세요.
GPS_DATA_CHAR_UUID = "0000ffe1-0000-1000-8000-00805f9b34fb"

# =================================================================
# 3. INPUT / MANUAL CONTROL (수동 조작)
# =================================================================

# 키보드 수동 조작 시의 기본 속도 및 조향 값
MANUAL_THROTTLE_SPEED = 0.7  # 전진/후진 속도 (0.0 ~ 1.0)
MANUAL_STEERING_ANGLE = 1.0  # 최대 좌/우 조향 각도 (0.0 ~ 1.0)

# =================================================================
# 4. CONTROL (메인 제어 로직)
# =================================================================

# 메인 제어 루프의 목표 주파수 (Hz)
# 20Hz는 1초에 20번 루프를 실행하며, 한 루프 당 0.05초가 소요됨을 의미합니다.
MAIN_LOOP_HZ = 20.0

# =================================================================
# 5. LOGGING (데이터 로깅)
# =================================================================

# 로깅 기능 전체 활성화/비활성화
LOG_ENABLE = True

# 로그 파일이 저장될 기본 디렉토리
LOG_BASE_DIR = 'logs' # 프로젝트 루트 폴더 아래에 'logs' 폴더 생성

# CSV 로그 파일 이름 (센서, 제어 값 등 텍스트 데이터)
LOG_CSV_FILENAME = 'ugv_log.csv'

# 카메라 이미지를 저장할 하위 디렉토리 이름
LOG_IMAGE_DIRNAME = 'images'

# 이미지 저장 주기 (Hz). 초당 저장할 이미지 수.
# 너무 높게 설정하면 라즈베리파이 성능에 부담이 될 수 있습니다.
LOG_IMAGE_SAVE_HZ = 1.0  # 초당 1회 이미지 저장

# --- 다른 모듈에서 사용할 전체 경로 (자동 생성되므로 수정 불필요) ---
LOG_CSV_FILE_PATH = os.path.join(LOG_BASE_DIR, LOG_CSV_FILENAME)
LOG_IMAGE_DIR_PATH = os.path.join(LOG_BASE_DIR, LOG_IMAGE_DIRNAME)
